All code licensed under public domain unless otherwise stated.
